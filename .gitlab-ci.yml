image: node

pages:
  script:
  - npm install -g tiddlywiki
  - cp -R * /usr/local/lib/node_modules/tiddlywiki/
  - tiddlywiki ./editions/collection --build
  - mv ./editions/collection/output public
  - cp -R ./files/* public
  artifacts:
    paths:
    - public
  only:
  - release

testing:
  script:
    - npm install -g tiddlywiki
    - cp -R * /usr/local/lib/node_modules/tiddlywiki/
    - tiddlywiki ./editions/collection --build
    - mv ./editions/collection/output public/dev
    - cp -R ./files/* public/dev
    - tiddlywiki ./editions/atom-feed --build
    - mv ./editions/atom-feed/output public/atom-feed
  artifacts:
    paths:
    - public
  only:
  - master
